# Grammar for Alpha

## Permanents
permanentCard -> ability? (newline ability)*

ability -> keywords
        -> staticAbility
        -> activatedAbility
        -> triggeredAbility

keywords -> keyword ((semicolon|comma)space keyword)*

activatedAbility -> costs colon space effect period (restriction period)?

triggeredAbility -> triggerCondition (comma space subordinateClause)? comma space effect (space subordinateClause)? period

staticAbility -> staticAbility space staticAbility
              -> subordinateClause comma space staticAbility
              -> replacementEffect period
              -> continuous period
              -> damage ' is dealt to ' object ' instead.'
              -> object ' do' ('es')? 'n’t untap during ' phase period
              -> object ' cost ' costs ' more to cast' period
              -> object ' able to block ' object ' do so' period
              -> player ' may have ' object ' enter ' zone ' as a copy of any ' object ' on ' zone (space except)? (period)?
              -> player ' control ' object
              -> player ' don’t lose the game for having 0 or less life' period
              -> player ' have no maximum hand size' period
              -> player ' may spend ' color ' mana as though it were ' color ' mana' period
              -> player ' may play any number of lands on each of your turns' period
              -> player ' skip ' phase period
              -> player ' can’t untap more than one ' object ' during ' phase period
              -> 'Activated abilities of ' object ' cost ' costs ' more to activate' period
              -> 'For each ' damage ' that would be dealt to ' object ', if ' condition ', remove a ' counter ' counter from it and prevent that ' damage period

replacementEffect -> subordinateClause comma space effect
                  -> object ' enters ' zone space prepositionalPhrase
                  -> object ' enters ' zone space 'tapped'
                  -> subordinateClause comma space 'instead' space effect
                  -> subordinateClause comma space effect ' instead'
                  -> subordinateClause comma space 'you may skip that turn instead. If you do, ' effect
                  -> subordinateClause comma space 'discard it, but you may put it on top of ' zone ' instead of into ' zone

except -> 'except it’s ' object ' in addition to its other types'
       -> 'except it doesn’t copy that creature’s color and it has “At the beginning of your upkeep, you may have this creature become a copy of target creature, except it doesn’t copy that creature’s color and it has this ability.”'
       -> 'except that the copy is ' color

triggerCondition -> triggerWord ' ' triggerEvent

triggerEvent -> 'the beginning of ' phase
             -> 'end of combat'
             -> player (space)? playerVerbPhrase
             -> object space objectVerbPhrase

playerVerbPhrase -> playerVerb space object
                 -> playerVerb space object ' for mana'
                 -> '’re dealt damage'

playerVerb -> rawPlayerVerb (plural)?

objectVerbPhrase -> 'enters' space zone
                 -> 'dies'
                 -> 'is dealt damage'
                 -> 'is tapped for mana'
                 -> 'is put into ' zone ' from ' zone
                 -> 'becomes tapped'
                 -> 'attack'
                 -> 'blocks or becomes blocked by ' object
                 -> 'deals damage to an opponent'
                 -> 'dealt damage by ' object ' this turn dies,'

subordinateClause -> subordinateConjunction space condition
                  -> subordinateConjunction space 'long' space subordinateConjunction space condition
                  -> subordinateConjunction space player space costs
                  -> subordinateConjunction space player ' controls ' object
                  -> subordinateConjunction object space 'enters' space zone
                  -> subordinateConjunction space player ' would draw ' object ' during ' phase
                  -> subordinateConjunction space player ' would gain life'
                  -> subordinateConjunction space player ' would begin your turn while ' object ' is tapped'
		  -> subordinateConjunction space 'an effect causes you to discard a card

subordinateConjunction -> 'as'
                       -> 'if'
                       -> 'unless'

condition -> object ' is ' ('un')? 'tapped'
          -> object ' isn’t ' object
          -> object ' isn’t attacking'
          -> object ' has a ' counter ' counter on it'
          -> object ' has flying'
          -> object ' is ' prepositionalPhrase space prepositionalPhrase
          -> object ' wasn’t the first land you played this turn'
          -> object ' attacked or blocked this combat'
          -> object ' are ' prepositionalPhrase
          -> object saxon space prepositionalPhrase

## Spells

spellCard -> spellAbility (\n spellAbility)*

modal -> 'Choose one ' dash (newline bullet space effect period)+

spellAbility -> effect '.' ((' then')? ' ' effect '.')*
             -> (effect ', ')? effect ', then ' effect '.'
             -> effect '. ' effect '. ' effect '.'
             -> restriction period
             -> modal
             -> player ' chooses a number of lands they control equal to ' amount ', then sacrifices the rest. Players discard cards and sacrifice creatures the same way.'
             -> 'Tap ' object ' and ' player ' loses all unspent mana.'
             -> 'At the beginning of ' phase ', destroy ' object '. Ignore this effect for each creature the player didn’t control continuously since the beginning of the turn.'
             -> 'Return ' object (' from ' zone)? ' to ' zone '.'
             -> 'Change the text of ' object ' by replacing all instances of one ' textAspect ' with another.'
             -> 'Copy ' object ', ' except '. You may choose new targets for the copy.'
             -> 'This turn, instead of declaring blockers, each defending player chooses any number of creatures they control and divides them into a number of piles equal to the number of attacking creatures for whom that player is the defending player. Creatures ' player ' control that can block additional creatures may likewise be put into additional piles. Assign each pile to a different one of those attacking creatures at random. Each creature in a pile that can block the creature that pile is assigned to does so'
             -> 'Until end of turn, any time you could activate a mana ability, you may ' costs '. If you do, ' effect '.'
             -> 'Look at the top ' amount ' cards of target player’s library, then put them back in any order. ' player ' may have ' player ' shuffle.'

restriction -> 'Cast ' object ' only during ' phase
            -> 'Cast ' object ' only before ' phase
            -> 'Spend only ' color ' mana on X'
            -> 'As an additional cost to cast this spell, ' costs
            -> 'This spell costs ' costs ' more to cast for each target beyond the first'
            -> 'Activate only during ' phase ('and only once each turn')?
            -> 'Remove ' object ' from your deck before playing if you’re not playing for ante'

## Effects

duration -> 'until end of turn'
         -> 'this turn'
         -> 'until ' object ' leaves ' zone
         -> 'until end of combat'
         -> 'each combat'

continuous -> continuous (' ' duration)? (' if able')?
           -> object ' gains ' keyword
           -> object ' gains trample and gets +X/+0 until end of turn, where X is ' amount '. At the beginning of the next end step, destroy that creature if it attacked this turn'
           -> object ' get' ('s')? ' ' statMod (' as long as you control a Swamp')?
           -> object ' gets +X/+Y, where X is ' amount ', and Y is ' amount
           -> object ' gets ' statMod ' until end of turn. If this ability has been activated four or more times this turn, sacrifice ' object ' at the beginning of the next end step'
           -> object ' get' ('s')? ' ' statMod ' and ha' ('s'|'ve') space ability
           -> object ' ha' ('s'|'ve') ' “' ability '”'
           -> object ' ha' ('s '|'ve ') ability (' and can’t be enchanted by ' object)? ('. this effect doesn't remove ' object)?
           -> object ' attack' (plural)?
           -> object ' can attack as though ' object ' didn't have defender'
           -> object ' can attack as though ' object ' had haste'
           -> object ' can’t attack' (' ' subordinateClause)?
           -> object ' can block ' object
           -> object ' can’t be blocked'
           -> object ' can’t be blocked ' ('except ')? 'by ' object
           -> object ' can’t block ' object
           -> object ' blocks ' object
           -> object ' gains flying until end of turn. Destroy ' object ' at the beginning of the next end step'
           -> object ' becomes ' color
           -> object ' becomes ' object
           -> object ' ' ('are'|'is'|'’s') ' ' object
           -> object (saxon)? 's power and toughness are each equal to ' amount

oneShot -> dealDamage
        -> manaEffect
        -> 'counter ' object (' unless its controller pays {X}. If that player doesn’t, they tap all lands with mana abilities they control and lose all unspent mana')
        -> 'choose a ' textAspect
        -> 'choose ' player
        -> 'destroy ' object (period space ('It'|'They') 'can’t be regenerated')?
        -> 'destroy ' object period space object ' deals damage to each creature and each player equal to ' amount
        -> 'destroy ' object ' at end of combat'
        -> 'destroy ' object period space player ' may attach ' object ' to ' object ' of their choice'
        -> 'exile ' object period space player ' gains life equal to ' amount
        -> 'sacrifice ' object (subordinateClause)?
        -> 'sacrifice ' object '. If you can’t, ' effect
        -> 'tap ' object ' and sacrifice ' object ' of an opponent’s choice'
        -> 'tap ' object
        -> 'untap ' object
        -> 'take an extra turn after this one'
        -> 'put a ' counter ' counter on ' object (' for each creature that died this turn')?
        -> 'put a ' counter ' counter on ' object '. That land is a Swamp for as long as it has a ' counter ' counter on it. Activate only during your upkeep'
        -> 'put that many ' counter ' counters on ' object
        -> 'put up to X ' counter ' counters on ' object '. This ability can’t cause the total number of +1/+0 counters on ' object ' to be greater than seven. Activate only during your upkeep'
        -> 'remove a ' counter ' counter from ' object
        -> 'Look' space 'at' space zone
        -> 'Search ' zone space prepositionalPhrase
        -> 'put' space object space prepositionalPhrase
        -> 'shuffle'
        -> 'ante the top card of ' zone
        -> (player space)? 'draw' (plural)? ' ' object
        -> player ' discards ' object (' at random')?
        -> player ' discards their hand'
        -> 'discard your hand'
        -> player ' lose the game'
        -> player ' lose life equal to ' amount
        -> player ' gain' (plural)? space number ' life'
        -> player ' gain life equal to ' amount period space object ' deals damage to ' something ' equal to ' amount '.'
        -> 'Create a 1/1 colorless Insect artifact creature token with flying named Wasp'
        -> 'exchange ' object ' with the top card of ' zone
        -> 'Regenerate ' object
        -> object ' become unblocked'

effect -> oneShot
       -> continuous
       -> 'Prevent ' damage ('. Until end of turn, you may pay {1} any time you could cast an instant. If you do, prevent the next 1 damage that would be dealt to that permanent or player this turn')?
       -> 'The next time a ' color ' source of your choice would deal damage to you this turn, prevent that damage'
       -> 'The next time a source of your choice would deal damage to you this turn, prevent that damage. You gain life equal to the damage prevented this way'
       -> 'The next time a source of your choice would deal damage to target creature this turn, that source deals that damage to you instead'
       -> 'The next ' number ' damage that would be dealt to ' object ' this turn is dealt to its owner instead. Only ' object '’s owner may activate this ability'
       -> 'its owner loses half their life, rounded up'
       -> 'Choose target non-Wall creature the active player has controlled continuously since the beginning of the turn. That creature attacks this turn if able. Destroy it at the beginning of the next end step if it didn’t attack this turn. Activate only during an opponent’s turn, before attackers are declared'
       -> 'If Chaos Orb is on the battlefield, flip Chaos Orb onto the battlefield from a height of at least one foot. If Chaos Orb turns over completely at least once during the flip, destroy all nontoken permanents it touches. Then destroy Chaos Orb'
       -> 'at the beginning of each of your upkeeps for the rest of the game, remove all mire counters from a land that a mire counter was put onto with Cyclopean Tomb but that a mire counter has not been removed from with Cyclopean Tomb'
       -> 'The next time an unblocked creature of your choice would deal combat damage to you this turn, prevent all but 1 of that damage'
       -> player ' antes the top card of ' zone
       -> player ' own ' object '
       -> player ' may ' costs '. If you do, ' effect
       -> player ' may ' effect
       -> player ' may tap or untap ' object
       -> player ' shuffles their hand and graveyard into ' zone
       -> 'until your next turn, ' player ' can’t be attacked except by creatures with flying and/or islandwalk'
       -> player ' may pay any amount of mana. ' object ' deals 2 damage to that player. Prevent X of that damage, where X is the amount of mana that player paid this way'
       -> player ' may choose a creature card in your hand whose mana cost could be paid by some amount of, or all of, the mana you spent on {X}. If you do, you may cast that card face down as a 2/2 creature spell without paying its mana cost. If the creature that spell becomes as it resolves has not been turned face up and would assign or deal damage, be dealt damage, or become tapped, instead it’s turned face up and assigns or deals damage, is dealt damage, or becomes tapped. Activate only as a sorcery.'
       -> player ' divides all creatures without flying they control into a “left” pile and a “right” pile. Then, for each attacking creature you control, choose “left” or “right.” That creature can’t be blocked this combat except by creatures with flying and creatures in a pile with the chosen label'
       -> 'it loses “enchant creature card in a graveyard” and gains “enchant creature put onto the battlefield with ~.” Return enchanted creature card to the battlefield under your control and attach ~ to it. When ~ leaves the battlefield, that creature’s controller sacrifices it'
       -> 'remove ' object ' from combat'
       -> player ' may have ' object ' block ' object ' of your choice'
       -> player ' activates a mana ability of ' object
       -> player ' loses all unspent mana and ' player ' add the mana lost this way'
       -> 'Look at ' zone ' and choose a card from it'
       -> player ' control ' player ' until ' object ' finishes resolving'
       -> 'The player plays that card if able. While doing so, the player can activate mana abilities only if they’re from lands that player controls and only if mana they produce is spent to activate other mana abilities of lands the player controls and/or to play that card. If the chosen card is cast as a spell, you control the player while that spell is resolving'

damage -> number ' damage'
       -> 'all combat damage that would be dealt this turn.'
       -> 'all damage that would be dealt to you by unblocked creatures'
       -> 'the next ' number ' damage that would be dealt to ' something ' this turn'

dealDamage -> object ' deals ' damage ' to ' something
           -> object ' deals ' damage ' to ' something ' and ' damage ' to ' something
           -> object ' deals ' damage ' to ' something ' and ' object ' gains "Enchanted creature loses flying"'
           -> object ' deals ' damage ' to ' something ', where X is ' amount
           -> object ' deals ' damage ' to ' something '. ' player ' gain life equal to the damage dealt, but not more life than the player’s life total before the damage was dealt, the planeswalker’s loyalty before the damage was dealt, or the creature’s toughness'
           -> object ' deals ' damage ' to ' something '. If it’s a creature, it can’t be regenerated this turn, and if it would die this turn, exile it instead'
           -> object ' deals ' damage ' divided evenly, rounded down, among any number of targets'
           -> object ' deals damage to ' something ' equal to ' amount
           -> object ' deals damage equal to ' amount ' to ' something

manaEffect -> 'add ' mana
           -> 'add an amount of ' mana ' equal to ' amount
           -> 'add ' amount ' mana of any ' ('one ')? 'color'
           -> player ' adds ' amount ' mana of any type that land produced'
           -> player ' adds an additional ' mana

## Definitions

adjective -> 'enchanted'
          -> 'tapped'
          -> 'blocking'
          -> 'attacking'
          -> 'sacrificed'
          -> 'token'
          -> 'additional'

amount -> 'half ' amount comma ' rounded ' ('up'|'down')
       -> englishNumber (space conjunction space 'more')?
       -> object (saxon)? 's toughness'
       -> object (saxon)? 's power'
       -> object (saxon)? 's mana value'
       -> 'X'
       -> 'the number of ' object (' minus ' number)?
       -> 'the damage dealt to ' player ' this turn'
       -> playerPossesive ' life total'
       -> 'that many'
       -> 'any number of'

costs -> ('pay' space)? cost (comma space costs)?

cost ->(mana)+
     -> lBracket tap rBracket
     -> number ' life'
     -> 'remove a ' counter ' counter from ' object
     -> 'sacrifice ' object
     -> 'skip ' demonstrative space ('turn'|'draw')

determiner -> article
           -> demonstrative
           -> amount

keyword -> 'enchant' object
        -> 'banding'
        -> 'first strike'
        -> 'flying'
        -> 'vigilance'
        -> 'defender'
        -> 'protection from ' color
        -> landType 'walk'
        -> 'indestructible'
        -> 'fear'
        -> 'haste'
        -> 'trample'
        -> 'reach'

mana -> (lBracket (manaLetter | number) rBracket)+

object -> premodifier space object
       -> object space postmodifier
       -> object plural
       -> (object comma space)* object space conjunction object
       -> tilde
       -> type
       -> 'card'
       -> 'spell'
       -> 'permanent'
       -> 'it'

postmodifier -> player ' control' (plural)?
             -> player ' controlled at the beginning of this turn'
             -> 'controlled by the player who controls the fewest'
             -> prepositionalPhrase
             -> preposition ' toughness less than ' amount
             -> preposition ' power and toughness each equal to ' amount
             -> 'named Plague Rats' space prepositionalPhrase
             -> 'that are still ' object
             -> 'other than ' object
             -> 'that didn’t attack this turn'
             -> object ' was blocking that had become blocked by ' object ' this combat'
             -> 'put into ' zone ' this way'

premodifier -> (premodifier comma space)+ premodifier
            -> (negation (space|dash))? adjective
            -> (negation (space|dash))? color
            -> determiner
            -> type
            -> number slash number

prepositionalPhrase -> prepositionalPhrase space prepositionalPhrase
                    -> preposition space zone
                    -> preposition space object
                    -> preposition space quality
                    -> preposition amount space counter ' counters on ' object

type -> negation (dash)? type
     -> cardType
     -> landType
     -> creatureType
     -> enchantmentType
     -> 'chosen type'

quality -> 'mana value' space number
        -> 'power' space number space conjunction space comparator
        -> keyword

phase -> playerPossesive space 'turn'
      -> playerPossesive space rawPhase (plural)?
      -> 'the ' rawPhase ' of ' object saxon ' controller'
      -> 'combat'
      -> 'an opponent’s turn' comma ' before attackers are declared'
      -> 'combat before blockers are declared'
      -> 'the' space rawPhase
      -> 'the next' space rawPhase

rawPhase -> turnPart
         -> turnPart space step
         -> turnPart space turnPart space step

player -> determiner space player
       -> player plural
       -> object saxon space 'controller'
       -> object saxon space 'owner'
       -> 'player'
       -> 'you'
       -> 'opponent'
       -> 'active player'
       -> 'defending player'
       -> 'they'

playerPossesive -> 'your'
                -> 'their'
                -> player saxon
                -> 'their controller' plural saxon
                -> 'its controller' saxon
                -> 'the chosen player' saxon

something -> object
          -> player
          -> determiner space 'target'
          -> something space conjunction space something

statMod -> plusMinus number slash plusMinus number

textAspect -> 'color word'
           -> 'basic land type'

zone -> playerPossesive space rawZone
     -> article space rawZone

counter -> statMod
        -> counterType

plusMinus -> plus
          -> dash

## Morphemes

article -> 'the'
        -> 'a'
        -> 'an'

cardType -> 'creature'
         -> 'land'
         -> 'artifact'
         -> 'enchantment'

color -> 'white'
      -> 'blue'
      -> 'black'
      -> 'green'
      -> 'red'

comparator -> 'less'
           -> 'greater'

conjunction -> 'and'
            -> 'or'

counterType -> 'corpse'
            -> 'vitality'
            -> 'mire'

creatureType -> 'Goblin'
             -> 'Golem'
             -> 'Merfolk'
             -> 'Wall'
             -> 'Zombie'

demonstrative -> 'this'
              -> 'these'
              -> 'those'
              -> 'that'

englishNumber -> 'one'
              -> 'two'
              -> 'three'
              -> 'seven'

enchantmentType -> 'aura'

landType -> 'plains'
         -> 'island'
         -> 'swamp'
         -> 'mountain'
         -> 'forest'

preposition -> 'with' ('out')?
            -> 'in' ('to')?
            -> 'above'
            -> 'on' ('to')?

rawDeterminer -> 'all'
              -> 'each'
              -> 'any'
              -> 'other'
              -> 'target'
              -> 'no'
              -> 'only'

rawPlayerVerb -> 'cast'
              -> 'tap'
              -> 'play'
              -> 'control'

rawZone -> 'graveyard'
        -> 'battlefield'
        -> 'hand'
        -> 'library'
        -> 'ante'

step -> 'step'

turnPart -> 'untap'
         -> 'upkeep'
         -> 'draw'
         -> 'declare'
         -> 'attackers'
         -> 'blockers'
         -> 'combat'
         -> 'damage'
         -> 'end'

triggerWord -> 'at'
            -> 'when'
            -> 'whenever'

## Lexemes

manaLetter -> 'W'
           -> 'U'
           -> 'B'
           -> 'R'
           -> 'G'
           -> 'C'

negation -> 'non'
         -> 'un'

number -> '0'
       -> '1'
       -> '2'
       -> '3'
       -> '4'
       -> '5'
       -> '6'
       -> '7'
       -> 'X'

plural -> 's'

saxon -> '’' ('s')?

tap -> 't'

## Symbols

bullet -> '•'

comma -> ','

colon -> ':'

dash -> '-'
     -> '—'

lBracket -> '{'

newline -> '\n'

period -> '.'

plus -> '+'

rBracket -> '}'

semicolon -> ';'

slash -> '/'

space -> ' '

tilde -> '~'
